//---------------------------------------------------
//         *****!Do not edit this file!*****
//---------------------------------------------------
//   ___  _              _
//  | _ \| | _  _  __ _ (_) _ _
//  |  _/| || || |/ _` || || ' \
//  |_|_ |_| \_,_|\__, ||_||_||_|
//  | __|_  _  _ _|___/ | |_ (_) ___  _ _   ___
//  | _|| || || ' \ / _||  _|| |/ _ \| ' \ (_-<
//  |_|  \_,_||_||_|\__| \__||_|\___/|_||_|/__/
//    ___  _              _    _
//   / __|| |_   ___  __ | |__(_)
//  | (__ | ' \ / -_)/ _|| / / _
//   \___||_||_|\___|\__||_\_\(_)
//---------------------------------------------------
// Purpose: If the plugin isn't loaded or some broke
// over new updates, then we check and redefine each
//              function individually.
//---------------------------------------------------

GetPlayerNameLoaded <- false
GetSteamIDLoaded <- false
AddChatCallbackLoaded <- false
SetPhysTypeConvarLoaded <- false

function RedefinedMessage(functionname) {
    if (GetDeveloperLevel()) {
        printl("(P2:MM): " + functionname + "() has been redefined!")
    }
}

function ReplaceGetPlayerName() {
    // Does the function exist?
    if ("GetPlayerName" in this) {
        GetPlayerNameLoaded <- true
        return
    }
    // Redefine
    function GetPlayerName(entinx) {
        return "player" + entinx
    }
    RedefinedMessage("GetPlayerName")
}

function ReplaceGetSteamID() {
    if ("GetSteamID" in this) {
        GetSteamIDLoaded <- true
        return
    }
    function GetSteamID(string) {
        return -1
    }
    RedefinedMessage("GetSteamID")
}

function ReplaceAddChatCallback() {
    if ("AddChatCallback" in this) {
        AddChatCallbackLoaded <- true
        return
    }
    function AddChatCallback(string) {
        printl("(P2:MM): Plugin not loaded. Unable to add chat callback for chat commands!")
    }
    RedefinedMessage("AddChatCallback")
}

function ReplaceSetPhysTypeConvar() {
    if ("SetPhysTypeConvar" in this) {
        SetPhysTypeConvarLoaded <- true
        return
    }
    function SetPhysTypeConvar(string) {
        printl("(P2:MM): Plugin not loaded. Unable to change game grab controllers!")
    }
    RedefinedMessage("SetPhysTypeConvar")
}

ReplaceGetPlayerName()
ReplaceGetSteamID()
ReplaceAddChatCallback()
ReplaceSetPhysTypeConvar()

if (GetPlayerNameLoaded || GetSteamIDLoaded || AddChatCallbackLoaded || SetPhysTypeConvarLoaded) {
    // Something loaded, so the plugin must be as well
    PluginLoaded <- true
}
else if (!GetPlayerNameLoaded && !GetSteamIDLoaded && !AddChatCallbackLoaded && !SetPhysTypeConvarLoaded) {
    // Nothing loaded
    PluginLoaded <- false
}